USE [JGHotel]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[USP_BATCH_KEYWORD_HOTEL]

/*
USP_BATCH_KEYWORD_HOTEL '179900'
*/

@CITY_CODE VARCHAR(20)

AS

SELECT TOP 600 A.HOTEL_CODE, NAME, ENG_NAME, C.CITY_CODE, C.CITY_NAME
FROM HTL_INFO_MAST_HOTEL A
JOIN HTL_INFO_PRICE B ON A.HOTEL_CODE=B.HOTEL_CODE
JOIN HTL_CODE_MAST_CITY C ON A.CITY_CODE=C.CITY_CODE
WHERE A.CITY_CODE=@CITY_CODE AND A.USE_YN='Y'
ORDER BY (CASE WHEN NAME LIKE '[A-z]%' THEN 1 ELSE 0 END) ASC, 
(CASE WHEN RV_POINT > 4 THEN 5 ELSE RV_POINT END) DESC, 
SALE_AMT ASC


GO
