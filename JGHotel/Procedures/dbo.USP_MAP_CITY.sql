USE [JGHotel]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[USP_MAP_CITY]          
          
/*          
USP_MAP_CITY '3724'          
*/          
          
@CITY_CODE VARCHAR(20)          
          
AS          

DECLARE @CNT INT;
          
SELECT CITYNAME, CITYENAME, COUNTRYCODE, STREET_VIEW, LANDMARK_YN,      
ISNULL(ZOOM_LEVEL,0) AS ZOOM_LEVEL,         
ISNULL(CENTER_LAT,0) AS CENTER_LAT,         
ISNULL(CENTER_LNG,0) AS CENTER_LNG        
INTO #TMP
FROM OMNIHOTEL.DBO.CHT_HOTELCITYCODE WHERE CITYCODE=(SELECT OLD_CODE FROM HTL_CODE_MAST_CITY WHERE CITY_CODE=@CITY_CODE)      

SELECT @CNT = COUNT(*) FROM #TMP

IF (@CNT > 0)
BEGIN
	SELECT * FROM #TMP
END
ELSE
BEGIN 
	SELECT CITY_NAME AS CITYNAME, CITY_ENAME AS CITYENAME,
	NATION_CODE AS COUNTRYCODE, 'N' AS STREET_VIEW, 'N' AS LANDMARK_YN, 
	0 AS ZOOM_LEVEL, 0 AS CENTER_LAT, 0 AS CENTER_LNG
	FROM HTL_CODE_MAST_CITY WHERE CITY_CODE=@CITY_CODE
END


GO
