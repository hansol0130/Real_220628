USE [JGHotel]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[USP_HTL_RESV_MAST_REFRESH]

@RESV_NO INT,
@SUPP_NO VARCHAR(50),
@SUPP_CFM_NO VARCHAR(300),
@HOTEL_CODE VARCHAR(50),
@HOTEL_NAME VARCHAR(300),
@S_HOTEL_CODE VARCHAR(50),
@S_HOTEL_NAME VARCHAR(300),
@CHECK_IN_DATE DATETIME,
@CHECK_OUT_DATE DATETIME,
@LAST_STATUS VARCHAR(4),
@SUPP_STATUS VARCHAR(4),
@ORG_CURRENCY VARCHAR(3),
@ORG_SUPP_NET DECIMAL(13, 5),
@ORG_TOTAL_AMT DECIMAL(13, 5),
@SUPP_NET DECIMAL(18, 0),
@TOTAL_AMT DECIMAL(18, 0),
@DEAD_LINE DATETIME,
@SUPP_DEAD_LINE DATETIME

AS

DECLARE @SQL VARCHAR(8000);
SET @SQL = '';
SET @SQL = @SQL + 'UPDATE HTL_RESV_MAST SET '; 
SET @SQL = @SQL + 'RESV_NO = RESV_NO '; 

IF (ISNULL(@SUPP_NO, '') <> '') SET @SQL = @SQL + ', SUPP_NO = @SUPP_NO '; 
IF (ISNULL(@SUPP_CFM_NO, '') <> '') SET @SQL = @SQL + ', SUPP_CFM_NO = @SUPP_CFM_NO '; 
IF (ISNULL(@HOTEL_CODE, '') <> '') SET @SQL = @SQL + ', HOTEL_CODE = @HOTEL_CODE '; 
IF (ISNULL(@HOTEL_NAME, '') <> '') SET @SQL = @SQL + ', HOTEL_NAME = @HOTEL_NAME '; 
IF (ISNULL(@S_HOTEL_CODE, '') <> '') SET @SQL = @SQL + ', S_HOTEL_CODE = @S_HOTEL_CODE '; 
IF (ISNULL(@S_HOTEL_NAME, '') <> '') SET @SQL = @SQL + ', S_HOTEL_NAME = @S_HOTEL_NAME '; 
IF (ISNULL(@CHECK_IN_DATE, '') <> '') SET @SQL = @SQL + ', CHECK_IN_DATE = @CHECK_IN_DATE '; 
IF (ISNULL(@CHECK_OUT_DATE, '') <> '') SET @SQL = @SQL + ', CHECK_OUT_DATE = @CHECK_OUT_DATE '; 
IF (ISNULL(@LAST_STATUS, '') <> '') SET @SQL = @SQL + ', LAST_STATUS = @LAST_STATUS '; 
IF (ISNULL(@SUPP_STATUS, '') <> '') SET @SQL = @SQL + ', SUPP_STATUS = @SUPP_STATUS '; 
IF (ISNULL(@ORG_CURRENCY, '') <> '') 
BEGIN
	SET @SQL = @SQL + ', ORG_CURRENCY = @ORG_CURRENCY '; 
	SET @SQL = @SQL + ', ORG_SUPP_NET = @ORG_SUPP_NET '; 
	SET @SQL = @SQL + ', ORG_TOTAL_AMT = @ORG_TOTAL_AMT '; 
END
IF (ISNULL(@SUPP_NET, '') <> '') SET @SQL = @SQL + ', SUPP_NET = @SUPP_NET '; 
IF (ISNULL(@TOTAL_AMT, '') <> '') SET @SQL = @SQL + ', TOTAL_AMT = @TOTAL_AMT '; 
IF (ISNULL(@DEAD_LINE, '') <> '') SET @SQL = @SQL + ', DEAD_LINE = @DEAD_LINE '; 
IF (ISNULL(@SUPP_DEAD_LINE, '') <> '') SET @SQL = @SQL + ', SUPP_DEAD_LINE = @SUPP_DEAD_LINE '; 

SET @SQL = @SQL + 'WHERE '; 
SET @SQL = @SQL + '	RESV_NO = @RESV_NO';

EXEC (@SQL);
GO
