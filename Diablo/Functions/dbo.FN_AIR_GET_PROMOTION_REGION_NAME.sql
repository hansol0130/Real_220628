USE [Diablo]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Author,,Name>
-- Create date: <Create Date, ,>
-- Description:	<Description, ,>
-- =============================================
--  110,310  -> 북미노선, 한일노선
CREATE FUNCTION [dbo].[FN_AIR_GET_PROMOTION_REGION_NAME]
(
	@SEPARATOR	CHAR(1),
	@LIST VARCHAR(100)
)
RETURNS VARCHAR(200)
AS
BEGIN
	DECLARE @REGION_NAME_LIST VARCHAR(200);
	SET @LIST = @LIST + ',';
	DECLARE @INDEX INT;
	DECLARE	@NEWTEXT VARCHAR(50);
	DECLARE @REGION_NAME VARCHAR(20);
	SET @INDEX = CHARINDEX(@SEPARATOR, @LIST);
	WHILE NOT(@INDEX = 0)
	BEGIN
		SET @NEWTEXT = RTRIM(LTRIM(LEFT(@LIST, @INDEX - 1)));
		SET @LIST = RIGHT(@LIST, LEN(@LIST) - @INDEX);
		SET @REGION_NAME = (SELECT KOR_NAME FROM PUB_REGION WITH(NOLOCK)  WHERE REGION_CODE = @NEWTEXT);
		IF @REGION_NAME_LIST <> ''
			SET @REGION_NAME_LIST = @REGION_NAME_LIST + ',' + @REGION_NAME;
		ELSE
			SET @REGION_NAME_LIST = @REGION_NAME;

		SET @INDEX = CHARINDEX(@SEPARATOR, @LIST);
	END

	RETURN @REGION_NAME_LIST;

END
GO
