USE [Diablo]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE FUNCTION [dbo].[FN_RES_GET_PAY_PRICE]
(
	@RES_CODE VARCHAR(20)
)
RETURNS DECIMAL
AS
BEGIN

	DECLARE @PAY_PRICE DECIMAL
	
	SELECT
		@PAY_PRICE = ISNULL(SUM(A.PART_PRICE), 0)
	--FROM PAY_MATCHING A WITH(NOLOCK) 
	FROM PAY_MATCHING A WITH(NOLOCK, INDEX(IDX_PAY_MATCHING_1)) 
	WHERE A.RES_CODE = @RES_CODE
	AND A.CXL_YN = 'N';
	-- 0 접수에서 7 환불까지
	
	RETURN (@PAY_PRICE)

END

GO
