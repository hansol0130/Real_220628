USE [Diablo]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE FUNCTION [dbo].[FN_SEQUENCE]
(    
    @FLAG VARCHAR(100)
)
RETURNS @RTNVALUE TABLE 
(
    DIGIT_SEQ INT IDENTITY(1,1),	-- 순차 번호
    DIGIT_NUM INT NOT NULL,			-- 자리 번호
    DIGIT_VALUE INT NOT NULL		-- 해당 자리 값
) 
AS
BEGIN
	-- 호텔 오프라인 판매로 인해 생성
	-- ex) @FLAG = '11111'
	DECLARE @SPACE INT, @SEQ INT
	
	SET @SPACE = LEN(@FLAG)
	SET @SEQ = 1
	
	WHILE (@SEQ <= @SPACE)
	BEGIN
		IF CONVERT(INT, SUBSTRING(@FLAG, @SEQ, 1)) > 0
		BEGIN
			INSERT INTO @RTNVALUE (DIGIT_NUM, DIGIT_VALUE)
			SELECT DIGIT_NUM = @SEQ, DIGIT_VALUE = CONVERT(INT, SUBSTRING(@FLAG, @SEQ, 1))
		END
		
		SET @SEQ = @SEQ + 1
	END
	
    RETURN
END

GO
