USE [Diablo]
GO
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




CREATE FUNCTION [dbo].[FN_RES_GET_DC_PRICE]
(
	@RES_CODE VARCHAR(20)
)
RETURNS INT
AS
BEGIN

	DECLARE @TOT_PRICE INT

	-- TOT_PRICE는 판매액
	-- PAY_PRICE는 입금액

	SELECT
		@TOT_PRICE = ISNULL(SUM(DC_PRICE), 0)
	FROM RES_CUSTOMER_DAMO WITH(NOLOCK) 
	WHERE RES_CODE = @RES_CODE
	AND RES_STATE IN (0, 3) -- 예약, 환불, 페널티

	RETURN (@TOT_PRICE)

END


GO
